@{
    string ControllerName = "Home";
    ViewBag.Root = "Home";
    ViewBag.Title = "Home Page";
}

<div class="content-wrapper">
    <!-- Content area -->
    <div class="content">
        <!-- Form inputs -->
        <div class="card animated bounceInLeft">
            <div class="card-header header-elements-inline">
                <h4 class="card-title">LAPORAN</h4>
            </div>
            <div class="card-body">
                @using (Html.BeginForm("Index", "Home", FormMethod.Post, new { id = "submitForm" }))
                {
                    <div class="row mt-0">
                        <div class="row col-lg-5">
                            <div class="col-lg-12">
                                <label class="mb-1">Jenis Laporan</label>
                                <div class="input-group">
                                    @Html.DropDownList("Reports", new SelectList(ViewBag.ReportList, "Value", "Text", "ReportA_get"), new { @class = "form-control select2" })
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="row col-lg-6">
                            <div class="col-lg-5">
                                <label class="mb-1">No PIB</label>
                                <div class="input-group">
                                    <input type="text" id="NoPIB" name="NoPIB" class="form-control" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="row col-lg-6">
                            <div class="col-lg-5">
                                <label class="mb-1">Periode PIB</label>
                                <div class="input-group mb-1">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">
                                            @Html.CheckBox("chkPIBPeriodStart", true, new { @class = "form-check-input check-styled" })
                                            <span class="ml-2">Awal</span>
                                        </div>
                                    </div>
                                    <input type="text" id="dtPIBPeriodStart" name="dtPIBPeriodStart" class="form-control daterange-picker text-center" />
                                </div>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">
                                            @Html.CheckBox("chkPIBPeriodEnd", true, new { @class = "form-check-input check-styled" })
                                            <span class="ml-2">Akhir</span>
                                        </div>
                                    </div>
                                    <input type="text" id="dtPIBPeriodEnd" name="dtPIBPeriodEnd" class="form-control daterange-picker text-center" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-check form-check-switchery mt-3">
                        <label class="form-check-label">
                            <input type="checkbox" id="Landscape" name="Landscape" class="form-check-input-switchery" value="true" />Landscape
                        </label>
                    </div>

                    <div class="mt-4">
                        <a href="javascript:void(0)" onclick="Print('Print','@ControllerName','true')" class="btn btn-primary"><i class="icon-printer2 mr-2"></i>Generate</a>
                        <button type="submit" class="btn btn-success"><i class="icon-file-excel mr-2"></i>EXCEL</button>
                        <a href="javascript:void(0)" onclick="Print('PrintToPdf','@ControllerName', 'false')" class="btn btn-danger"><i class="icon-file-pdf mr-2"></i>PDF</a>
                    </div>
                }
            </div>
        </div>
        <!-- /form inputs -->
    </div>
    <!-- /content area -->
</div>

<script type="text/javascript">

    $(document).ready(function () {
        activateMenu('Home');

    });

    function Print(action, controller, opennewwindow) {
        var url = '@Url.Action("__action", "__controller", new { Reports = "__data" })';
        url = url.replace("__action", action).replace("__controller", controller);
        url = url.replace("__data", getFilter());
        OpenWindow(url, opennewwindow);
    }

    function getFilter() {
        return $('#Reports').val()
                + "&chkPIBPeriodStart=" + $('#chkPIBPeriodStart').val()
                + "&dtPIBPeriodStart=" + $('#dtPIBPeriodStart').val()
                + "&chkPIBPeriodEnd=" + $('#chkPIBPeriodEnd').val()
                + "&dtPIBPeriodEnd=" + $('#dtPIBPeriodEnd').val()
                + "&Landscape=" + $('#Landscape').val()
            ;
    }

    function OpenWindow(url, opennewwindow) {
        if (opennewwindow == "true")
            window.open(url, '_blank');
        else
            window.location.href = url;
    }

</script>

